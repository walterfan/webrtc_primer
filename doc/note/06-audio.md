# Audio Overview

人的听觉特性

* 20Hz ~ 20kHz
* -5db ~ 130db



# Audio API


# Audio codec

* opus is required



## Code Requirements

According to https://tools.ietf.org/html/rfc7874

WebRTC endpoints are REQUIRED to implement the following audio codecs:

* Opus [RFC6716] with the payload format specified in [RFC7587].

* PCMA and PCMU (as specified in ITU-T Recommendation G.711 [G.711])
  with the payload format specified in Section 4.5.14 of [RFC3551].
      
      
* [RFC3389] comfort noise (CN).  WebRTC endpoints MUST support [RFC3389] CN for streams encoded with G.711 or any other supported codec that does not provide its own CN.  
 Since Opus provides its own CN mechanism, the use of [RFC3389] CN with Opus is NOT RECOMMENDED.  
 Use of Discontinuous Transmission (DTX) / CN by senders is OPTIONAL.      


*  the 'audio/telephone-event' media type as specified in [RFC4733].
   The endpoints MAY send DTMF events at any time and SHOULD suppress in-band dual-tone multi-frequency (DTMF) tones, if any.  
   DTMF events generated by a WebRTC endpoint MUST have a duration of no more than 8000 ms and no less than 40 ms.  
   
   The recommended default duration is 100 ms for each tone.  
   The gap between events MUST be no less than 30 ms; the recommended default gap duration is 70 ms.
   
   WebRTC endpoints are not required to do anything with tones (as specified in RFC 4733) sent to them, except gracefully drop them.
   There is currently no API to inform JavaScript about the received DTMF or other tones (as specified in RFC 4733).  
   
   WebRTC endpoints are REQUIRED to be able to generate and consume the following  events:
   
   
   ```
      
         +------------+--------------------------------+-----------+
         |Event Code  | Event Name                     | Reference |
         +------------+--------------------------------+-----------+
         | 0          | DTMF digit "0"                 | [RFC4733] |
         | 1          | DTMF digit "1"                 | [RFC4733] |
         | 2          | DTMF digit "2"                 | [RFC4733] |
         | 3          | DTMF digit "3"                 | [RFC4733] |
         | 4          | DTMF digit "4"                 | [RFC4733] |
         | 5          | DTMF digit "5"                 | [RFC4733] |
         | 6          | DTMF digit "6"                 | [RFC4733] |
         | 7          | DTMF digit "7"                 | [RFC4733] |
         | 8          | DTMF digit "8"                 | [RFC4733] |
         | 9          | DTMF digit "9"                 | [RFC4733] |
         | 10         | DTMF digit "*"                 | [RFC4733] |
         | 11         | DTMF digit "#"                 | [RFC4733] |
         | 12         | DTMF digit "A"                 | [RFC4733] |
         | 13         | DTMF digit "B"                 | [RFC4733] |
         | 14         | DTMF digit "C"                 | [RFC4733] |
         | 15         | DTMF digit "D"                 | [RFC4733] |
         +------------+--------------------------------+-----------+

   ```
   

   For all cases where the endpoint is able to process audio at a sampling rate higher than 8 kHz, it is RECOMMENDED that Opus be offered before PCMA/PCMU.  
   
   For Opus, all modes MUST be supported on the decoder side.  The choice of encoder-side modes is left to the implementer.  
   
   Endpoints MAY use the offer/answer mechanism to signal a preference for a particular mode or ptime.


## Opus


The Opus codec is designed for interactive speech and audio transmission over the Internet. 
It is designed by the IETF Codec Working Group and incorporates technology from Skype's SILK codec and Xiph.Org's CELT codec.

The Opus codec is designed to handle a wide range of interactive audio applications, 
including Voice over IP, videoconferencing, in-game chat, and even remote live music performances. 

It can scale from low bit-rate narrowband speech to very high quality stereo music. 

Its main features are:

* Sampling rates from 8 to 48 kHz
* Bit-rates from 6 kb/s to 510 kb/s
* Support for both constant bit-rate (CBR) and variable bit-rate (VBR)
* Audio bandwidth from narrowband to full-band
* Support for speech and music
* Support for mono and stereo
* Support for multichannel (up to 255 channels)
* Frame sizes from 2.5 ms to 60 ms
* Good loss robustness and packet loss concealment (PLC)
* Floating point and fixed-point implementation


# Build Opus
* Download opus-1.3.1.tar.gz from [Opus site](http://opus-codec.org)

* Build by Emscripten tool chain

```shell script
emconfigure ./configure --disable-intrinsics --disable-rtcd`   
emmake make
```



# Reference
* [ Definition of the Opus Audio Codec](https://tools.ietf.org/html/rfc6716)
* [RTP Payload Format for the Opus Speech and Audio Codec](https://tools.ietf.org/html/rfc7587)
* [Updates to the Opus Audio Codec](https://tools.ietf.org/html/rfc8251)
* [Opus codec](http://opus-codec.org)