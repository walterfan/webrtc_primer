##########################
Voice Activity Detection
##########################

.. include:: ../links.ref
.. include:: ../tags.ref
.. include:: ../abbrs.ref

============ ==========================
**Abstract** Voice Activity Detection
**Authors**  Walter Fan
**Status**   WIP
**Updated**  |date|
============ ==========================

.. |date| date::

.. contents::
   :local:

概述
===================


VAD in Opus determines whether a frame is sent out as empty (DTX) or not.

If speech is classified as silence (false negative), the frame will be empty and speech will be lost
False negative rate(FNR) needs to be as close to zero as possible when DTX is enabled
the different VAD in opus codec under different complexity, VAD ON will tigger DTX ON（400ms）,and VAD's decision will decide whether we should play CNG on playback.

the RNN-VAD is used when complexity setting >=7(float),which means when complexity <7,we use traditional VAD.


CNG
========================


There is a Real-time Transport Protocol (RTP) Payload for Comfort Noise (CN).
(refer to RFC 3389 )

The payload format provides a minimum interoperability specification for communication of comfort noise parameters.  The comfort noise analysis and synthesis as well as the Voice Activity Detection (VAD) and DT

Two popular types of VAD/CNG schemes are included in G.711.

The noise power levels in both VAD/CNG methods are expressed in −dBov to interoperate with each other.

The unit “dBov” is the dB level relative to the overload of the system. It is not a Volts reference for dBV.

For example, in the case of μ-law-based coding, the maximum sine wave signal power without distortion is 3.17 dBm with amplitude ±8159. Square wave power is 3 dB more than sine wave power. The maximum possible power of signal from a square wave with an amplitude of ±8159 is 0 dBov as reference, which corresponds to a 6.17-dBm power level in the μ-law system. Hence, 0 dBov = 6.17 dBm is used in μ-law system. Sine and square wave power levels and signal amplitudes are shown in Fig. 4.1(c). Representation relative to the overload point of a system is particularly useful for digital implementations, because one does not need to know the relative calibration of the analog circuitry.


VAD definition
========================
* SILK VAD(SNR based)
 
SILK VAD is based on SNR, which estimates the noise level to determine speech activity
The Voice Activity Detector (VAD) generates a measure of speech activity by combining the signal-to-noise ratios (SNRs) from 4 separate frequency bands. In each band the background noise level is estimated by smoothing the inverse energy over time frames.
Multiplying this smoothed inverse energy with the subband energy gives the SNR.

* Opus VAD(RNN based)

Opus VAD uses recursive neural network based on GRU units to perform both speech/music and speech/silence classification:
