

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Transport-wide Congestion Control &mdash; webrtc_tutorial 1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Congeston Control Evaluation" href="webrtc_cc_evaluation.html" />
    <link rel="prev" title="Google REMB" href="webrtc_remb.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> webrtc_tutorial
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../outline.html">目录</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1.basic/index.html">1. WebRTC 基础</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2.transport/index.html">2. WebRTC 传输</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">3. WebRTC 媒体</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="overview.html">WebRTC 媒体概论</a></li>
<li class="toctree-l2"><a class="reference internal" href="webrtc_audio.html">WebRTC 音频</a></li>
<li class="toctree-l2"><a class="reference internal" href="webrtc_video.html">WebRTC 视频</a></li>
<li class="toctree-l2"><a class="reference internal" href="webrtc_qos.html">WebRTC QoS</a></li>
<li class="toctree-l2"><a class="reference internal" href="webrtc_fec.html">WebRTC FEC</a></li>
<li class="toctree-l2"><a class="reference internal" href="webrtc_rtx.html">WebRTC RTX</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="webrtc_rcc.html">WebRTC 拥塞控制</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="webrtc_gcc.html">Google Congestion Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="webrtc_remb.html">Google REMB</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Transport-wide Congestion Control</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">概述</a></li>
<li class="toctree-l4"><a class="reference internal" href="#transport-wide-sequence-number">Transport-wide Sequence Number</a></li>
<li class="toctree-l4"><a class="reference internal" href="#transport-wide-rtcp-feedback-message">Transport-wide RTCP Feedback Message</a></li>
<li class="toctree-l4"><a class="reference internal" href="#receive-delta">Receive Delta</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sender-bandwidth-estimation">Sender Bandwidth Estimation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">参考资料</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="webrtc_cc_evaluation.html">Congeston Control Evaluation</a></li>
<li class="toctree-l3"><a class="reference internal" href="webrtc_rcc.html#id2">简介</a></li>
<li class="toctree-l3"><a class="reference internal" href="webrtc_rcc.html#id5">基本架构</a></li>
<li class="toctree-l3"><a class="reference internal" href="webrtc_rcc.html#id6">术语</a></li>
<li class="toctree-l3"><a class="reference internal" href="webrtc_rcc.html#id7">交互式实时媒体的拥塞控制的需求</a></li>
<li class="toctree-l3"><a class="reference internal" href="webrtc_rcc.html#id10">标准化组织及其发布的文档</a></li>
<li class="toctree-l3"><a class="reference internal" href="webrtc_rcc.html#id11">标准化状况和存在的问题</a></li>
<li class="toctree-l3"><a class="reference internal" href="webrtc_rcc.html#id16">常用方法</a></li>
<li class="toctree-l3"><a class="reference internal" href="webrtc_rcc.html#id17">拥塞控制算法</a></li>
<li class="toctree-l3"><a class="reference internal" href="webrtc_rcc.html#id21">对于拥塞控制算法的评估和验证</a></li>
<li class="toctree-l3"><a class="reference internal" href="webrtc_rcc.html#id24">参考资料</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="insertable_stream.html">Insertable Stream</a></li>
<li class="toctree-l2"><a class="reference internal" href="web_codec.html">Web Codecs</a></li>
<li class="toctree-l2"><a class="reference internal" href="web_transport.html">Web Transport</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../4.practice/index.html">4. WebRTC 实践</a></li>
<li class="toctree-l1"><a class="reference internal" href="../5.tool/index.html">5. WebRTC 工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="../6.misc/index.html">6. WebRTC 关联技术</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">webrtc_tutorial</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">3. WebRTC 媒体</a> &raquo;</li>
        
          <li><a href="webrtc_rcc.html">WebRTC 拥塞控制</a> &raquo;</li>
        
      <li>Transport-wide Congestion Control</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/3.media/webrtc_tcc.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="transport-wide-congestion-control">
<h1>Transport-wide Congestion Control<a class="headerlink" href="#transport-wide-congestion-control" title="Permalink to this headline">¶</a></h1>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 81%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Abstract</strong></p></td>
<td><p>RTP Extensions for Transport-wide Congestion Control</p></td>
</tr>
<tr class="row-even"><td><p><strong>Authors</strong></p></td>
<td><p>Walter Fan</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Status</strong></p></td>
<td><p>WIP</p></td>
</tr>
<tr class="row-even"><td><p><strong>Updated</strong></p></td>
<td><p>2021-11-23</p></td>
</tr>
</tbody>
</table>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#id2" id="id4">概述</a></p></li>
<li><p><a class="reference internal" href="#transport-wide-sequence-number" id="id5">Transport-wide Sequence Number</a></p></li>
<li><p><a class="reference internal" href="#transport-wide-rtcp-feedback-message" id="id6">Transport-wide RTCP Feedback Message</a></p>
<ul>
<li><p><a class="reference internal" href="#rtp-packet-status" id="id7">Rtp Packet Status</a></p></li>
<li><p><a class="reference internal" href="#packet-chunk" id="id8">Packet chunk</a></p>
<ul>
<li><p><a class="reference internal" href="#run-length-chunk" id="id9">Run Length Chunk</a></p></li>
<li><p><a class="reference internal" href="#status-vector-chunk" id="id10">Status Vector Chunk</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#receive-delta" id="id11">Receive Delta</a></p></li>
<li><p><a class="reference internal" href="#sender-bandwidth-estimation" id="id12">Sender Bandwidth Estimation</a></p>
<ul>
<li><p><a class="reference internal" href="#trendline-filter" id="id13">Trendline filter</a></p></li>
<li><p><a class="reference internal" href="#overuse-detector" id="id14">Overuse detector</a></p></li>
<li><p><a class="reference internal" href="#aimd-controller" id="id15">AIMD controller</a></p></li>
<li><p><a class="reference internal" href="#bandwidth-estimator" id="id16">Bandwidth estimator</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id3" id="id17">参考资料</a></p></li>
</ul>
</div>
<div class="section" id="id2">
<h2><a class="toc-backref" href="#id4">概述</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Transport wide sequence numbers header extension
在 RTP 包中添加一个扩展头，放置传输层面的序号</p></li>
</ol>
<p>SDP</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">=</span><span class="n">extmap</span><span class="p">:</span><span class="mi">5</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">ietf</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="nb">id</span><span class="o">/</span><span class="n">draft</span><span class="o">-</span><span class="n">holmer</span><span class="o">-</span><span class="n">rmcat</span><span class="o">-</span><span class="n">transport</span><span class="o">-</span><span class="n">wide</span><span class="o">-</span><span class="n">cc</span><span class="o">-</span><span class="n">extensions</span><span class="o">-</span><span class="mi">01</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Transport Feedback
增加一个 RTCP 反馈消息，用来反馈接收到的数据包及其延迟的信息 RTCP-Transport-FB 默认发送频率 1time/100ms，同时其动态适应使用 5％的可用带宽，最大频率值为 1time/50ms、最小频率值为 1time/250ms。以 1time/100ms 的频率发送，其最大需要耗费 16kbps 带宽</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">=</span><span class="n">rtcp</span><span class="o">-</span><span class="n">fb</span><span class="p">:</span><span class="mi">100</span> <span class="n">transport</span><span class="o">-</span><span class="n">cc</span>
</pre></div>
</div>
</div>
<div class="section" id="transport-wide-sequence-number">
<h2><a class="toc-backref" href="#id5">Transport-wide Sequence Number</a><a class="headerlink" href="#transport-wide-sequence-number" title="Permalink to this headline">¶</a></h2>
<p>在每个要发送的 RTP 包中添加一个扩展头，包含 16 bits 的序号 sequence number.  在同一个传输通道中，每发一个 RTP 包，这个序号就加一</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="mi">0</span>                   <span class="mi">1</span>                   <span class="mi">2</span>                   <span class="mi">3</span>
 <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>       <span class="mh">0xBE</span>    <span class="o">|</span>    <span class="mh">0xDE</span>       <span class="o">|</span>           <span class="n">length</span><span class="o">=</span><span class="mi">1</span>            <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>  <span class="n">ID</span>   <span class="o">|</span> <span class="n">L</span><span class="o">=</span><span class="mi">1</span>   <span class="o">|</span><span class="n">transport</span><span class="o">-</span><span class="n">wide</span> <span class="n">sequence</span> <span class="n">number</span> <span class="o">|</span> <span class="n">zero</span> <span class="n">padding</span>  <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
</pre></div>
</div>
</div>
<div class="section" id="transport-wide-rtcp-feedback-message">
<h2><a class="toc-backref" href="#id6">Transport-wide RTCP Feedback Message</a><a class="headerlink" href="#transport-wide-rtcp-feedback-message" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="mi">0</span>                   <span class="mi">1</span>                   <span class="mi">2</span>                   <span class="mi">3</span>
 <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span><span class="n">V</span><span class="o">=</span><span class="mi">2</span><span class="o">|</span><span class="n">P</span><span class="o">|</span>  <span class="n">FMT</span><span class="o">=</span><span class="mi">15</span> <span class="o">|</span>    <span class="n">PT</span><span class="o">=</span><span class="mi">205</span>     <span class="o">|</span>           <span class="n">length</span>              <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>                     <span class="n">SSRC</span> <span class="n">of</span> <span class="n">packet</span> <span class="n">sender</span>                     <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>                      <span class="n">SSRC</span> <span class="n">of</span> <span class="n">media</span> <span class="n">source</span>                     <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>      <span class="n">base</span> <span class="n">sequence</span> <span class="n">number</span>     <span class="o">|</span>      <span class="n">packet</span> <span class="n">status</span> <span class="n">count</span>      <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>                 <span class="n">reference</span> <span class="n">time</span>                <span class="o">|</span> <span class="n">fb</span> <span class="n">pkt</span><span class="o">.</span> <span class="n">count</span> <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>          <span class="n">packet</span> <span class="n">chunk</span>         <span class="o">|</span>         <span class="n">packet</span> <span class="n">chunk</span>          <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">.</span>                                                               <span class="o">.</span>
<span class="o">.</span>                                                               <span class="o">.</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>         <span class="n">packet</span> <span class="n">chunk</span>          <span class="o">|</span>  <span class="n">recv</span> <span class="n">delta</span>   <span class="o">|</span>  <span class="n">recv</span> <span class="n">delta</span>   <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">.</span>                                                               <span class="o">.</span>
<span class="o">.</span>                                                               <span class="o">.</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>           <span class="n">recv</span> <span class="n">delta</span>          <span class="o">|</span>  <span class="n">recv</span> <span class="n">delta</span>   <span class="o">|</span> <span class="n">zero</span> <span class="n">padding</span>  <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
</pre></div>
</div>
<ul class="simple">
<li><p>version (V):  2 bits This field identifies the RTP version.  The current version is 2.</p></li>
<li><p>padding (P):  1 bit If set, the padding bit indicates that the packet contains additional padding octets at the end that are not part of the control information but are included in the length field.</p></li>
<li><p>feedback message type (FMT):  5 bits This field identifies the type of the FB message.  It must have the value 15.</p></li>
<li><p>payload type (PT):  8 bits This is the RTCP packet type that  identifies the packet as being an RTCP FB message. The value must be RTPFB = 205.</p></li>
<li><p>SSRC of packet sender:  32 bits The synchronization source identifier for the originator of this packet.</p></li>
<li><p>SSRC of media source:  32 bits The synchronization source identifier of the media source that this piece of feedback</p></li>
<li><p>information is related to.  TODO: This is transport wide, do we just pick any of the media source SSRCs?</p></li>
<li><p>base sequence number:  16 bits The transport-wide sequence number of the first packet in this feedback.  This number is not necessarily increased for every feedback; in the case of reordering it may be decreased.
- 该 fb 包首个 rtp 包的 transport seq，非 rtp 包序列号。</p></li>
<li><p>packet status count:  16 bits The number of packets this feedback  contains status for, starting with the packet identified by the base sequence number.
- 该 fb packet 包含 rtp 包个数。</p></li>
<li><p>reference time:  24 bits Signed integer indicating an absolute reference time in some (unknown) time base chosen by the sender of the feedback packets.  The value is to be  interpreted in multiples of 64ms.  The first recv delta in this packet is relative to the reference time.  The reference time makes it possible to calculate the delta between feedbacks even if some feedback packets are lost,  since it always uses the same time base.
- 参考时间，fb 包首个 rtp 的到达时间/64</p></li>
<li><p>feedback packet count:  8 bits A counter incremented by one for each feedback packet sent.  Used to detect feedback packet losses.
- 已发送 feedback 包计数器，可用于 fb packet 丢失检测</p></li>
<li><p>packet chunk:  16 bits A list of packet status chunks.  These indicate the status of a number of packets starting with the one identified by base sequence number.  See below  for details.
- 描述 rtp 包 4 种状态（见：4.2），有 Run Length Chunk 和 Status Vector Chunk 两种格式</p></li>
<li><p>recv delta: 8 bits For each “packet received” status, in the packet  status chunks, a receive delta block will follow.  See details below.
- 当 rtp 包的状态为 Packet received，通过 recv delta 记录其与前一个 rtp 包到达的时间间隔。</p></li>
</ul>
<div class="section" id="rtp-packet-status">
<h3><a class="toc-backref" href="#id7">Rtp Packet Status</a><a class="headerlink" href="#rtp-packet-status" title="Permalink to this headline">¶</a></h3>
<p>包的状态 (Packet Status) 表示为 2 个比特的符号：</p>
<ul class="simple">
<li><p>00 Packet not received （包未收到）</p></li>
<li><p>01 Packet received, small delta （包收到，间隔时间很小 ）</p></li>
<li><p>10 Packet received, large or negative delta（ 包收到，间隔时间很大或者为负数）</p></li>
<li><p>11 [Reserved], packet received, w/o recv delta (包收到了，但是没有间隔时间)</p></li>
</ul>
</div>
<div class="section" id="packet-chunk">
<h3><a class="toc-backref" href="#id8">Packet chunk</a><a class="headerlink" href="#packet-chunk" title="Permalink to this headline">¶</a></h3>
<p>packet  chunk 对 rtp 的到达状态进行描述，它有两种类型</p>
<ul class="simple">
<li><p>Run Length Chunk</p></li>
<li><p>Status Vector Chunk</p></li>
</ul>
<p>通过第一个比特位标识了是哪种类型</p>
<ul class="simple">
<li><p>0 ：Run Length Chunk</p></li>
<li><p>1 ：Status Vector Chunk</p></li>
</ul>
<div class="section" id="run-length-chunk">
<h4><a class="toc-backref" href="#id9">Run Length Chunk</a><a class="headerlink" href="#run-length-chunk" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="mi">0</span>                   <span class="mi">1</span>
 <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span><span class="n">T</span><span class="o">|</span> <span class="n">S</span> <span class="o">|</span>       <span class="n">Run</span> <span class="n">Length</span>        <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
</pre></div>
</div>
<div class="sidebar">
<p class="sidebar-title">行程编码</p>
<p>编码原理是把数据看成一个线性序列，而这些数据序列组织方式分成两种情况：
1) 连续的重复数据块，
2) 连续的不重复数据块。</p>
<p>对于连续的重复数据快采用的压缩策略是用一个字节（我们称之为数据重数属性）表示数据块重复的次数，然后在这个数据重数属性字节后面存储对应的数据字节本身举个例子：</p>
<p>原始数据：A-A-A-A-A-B-B-C-D</p>
<ul class="simple">
<li><p>压缩前：A-A-A-A-A-B-B-C-D（0x41-0x41-0x41-0x41-0x41-0x42-0x42-0x43-0x44）</p></li>
<li><p>压缩后： 5-A-2-B-1-C-1-D（0x05-0x41-0x02-0x42-0x01-0x43-0x01-0x44）</p></li>
</ul>
</div>
<p>字段含义如下</p>
<ul class="simple">
<li><p>T (1 bit) : chunk type，当为 Run Length Chunk ，此时值为 0。</p></li>
<li><p>S (1 bit)  ：packet status symbo，2 bits ，表示包的到达状态</p></li>
<li><p>Run Length (13 bit) ：表示多少个连续包的状态</p></li>
</ul>
<p>例 1：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   0                   1
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |0|0 0|0 0 0 0 0 1 1 0 1 1 1 0 1|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

00 代表包未收到 &quot;packet not received&quot; 后面13个比特值为 221，表示221个包未收到
</pre></div>
</div>
<p>例 2:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    0                   1
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |0|1 1|0 0 0 0 0 0 0 0 1 1 0 0 0|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

11 代表 &quot;packet received, w/o recv delta&quot; ，共有 24 个包，不过没有间隔时间数据
</pre></div>
</div>
</div>
<div class="section" id="status-vector-chunk">
<h4><a class="toc-backref" href="#id10">Status Vector Chunk</a><a class="headerlink" href="#status-vector-chunk" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="mi">0</span>                   <span class="mi">1</span>
 <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span><span class="n">T</span><span class="o">|</span><span class="n">S</span><span class="o">|</span>       <span class="n">symbol</span> <span class="nb">list</span>         <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
</pre></div>
</div>
<ul class="simple">
<li><p>T(1 bit): chunk type， 当为 Status Vector Chunk ，此时值为 1。</p></li>
<li><p>S(1 bit): symbol size 符号长度，0 表示符号长度为 14， 1 表示符号长度为 7</p></li>
<li><p>Symbol list(14 bits)，符号表，描述了 x 个包的到达状态，x 的数量取决于 S 的值，
- 当 S = 0 时 x = 14，每个符号为 1 个比特， 0 代表没收到，1 代表收到了
- 当 S = 1 时 x = 7， 每个符号为 2 个比特， 00，01，10，11 表示包的状态</p></li>
</ul>
<p>例 1:</p>
<p>这块数据中 S = 0 ，包含了 14 个包的状态，用 14 个比特位描述， 0 代表没收到，1 代表收到了</p>
<blockquote>
<div><p>1x “packet not received” - 第一个包没收到
5x “packet received”     - 之后 5 个包收到了
3x “packet not received” - 之后 3 个包没收到
3x “packet received”     - 之后 3 个包收到了
2x “packet not received” - 之后 2 个包没收到</p>
</div></blockquote>
<p>例 2:</p>
<p>这块数据中 S = 1 ，包含了 7 个包的状态，每个包用 2 个比特来描述</p>
<blockquote>
<div><p>1x “packet not received”</p>
<p>1x “packet received, w/o timestamp”</p>
<p>3x “packet received”</p>
<p>2x “packet not received”</p>
</div></blockquote>
</div>
</div>
</div>
<div class="section" id="receive-delta">
<h2><a class="toc-backref" href="#id11">Receive Delta</a><a class="headerlink" href="#receive-delta" title="Permalink to this headline">¶</a></h2>
<p>当包的状态为 Packet received，此时 fb packet 会通过 Receive Delta 记录其与前一个 RTP 包到达时间的间隔，单位是 250us.</p>
<ul class="simple">
<li><p>当状态是 “Packet received, small delta”，用 8-bit unsigned 存储 delta，此时 delta 取值为 <cite>[0,255] * 250</cite></p></li>
<li><p>当状态是 “Packet received, large or negative delta”，用 16-bit signed 存储 delta，此时 delta 取值为 <cite>[-32767, 32768] * 250</cite></p></li>
</ul>
<p>其他情况，用使用新的 fb 包</p>
</div>
<div class="section" id="sender-bandwidth-estimation">
<h2><a class="toc-backref" href="#id12">Sender Bandwidth Estimation</a><a class="headerlink" href="#sender-bandwidth-estimation" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>GoogleCcNetworkController</p></li>
<li><p>SendSideBandwidthEstimator</p></li>
<li><p>DelayBaseBwe
- Interarrival
- Trendline
- AIMDRateController</p></li>
<li><p>Trendline</p></li>
</ul>
<div class="section" id="trendline-filter">
<h3><a class="toc-backref" href="#id13">Trendline filter</a><a class="headerlink" href="#trendline-filter" title="Permalink to this headline">¶</a></h3>
<p>第 i 个包组的单向延迟变化 One-Way Delay Variation 计算如下</p>
<div class="math notranslate nohighlight">
\[d_i = (G_i.complete\_time - G_{i-1}.complete\_time)\]</div>
</div>
<div class="section" id="overuse-detector">
<h3><a class="toc-backref" href="#id14">Overuse detector</a><a class="headerlink" href="#overuse-detector" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="aimd-controller">
<h3><a class="toc-backref" href="#id15">AIMD controller</a><a class="headerlink" href="#aimd-controller" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="bandwidth-estimator">
<h3><a class="toc-backref" href="#id16">Bandwidth estimator</a><a class="headerlink" href="#bandwidth-estimator" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="id3">
<h2><a class="toc-backref" href="#id17">参考资料</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://datatracker.ietf.org/doc/html/draft-holmer-rmcat-transport-wide-cc-extensions-01">RTP Extensions for Transport-wide Congestion Control (draft-holmer-rmcat-transport-wide-cc-extensions-01)</a></p></li>
<li><p><a class="reference external" href="https://xie.infoq.cn/article/8a8ad2f8170d0072941c2aa9e">Webrtc Rtp/rtcp （2）</a></p></li>
<li><p><cite>webrtc 即时带宽评估器（BitrateEstimator）&lt;https://xie.infoq.cn/article/2f944089023274ef0ac6eabd8&gt;</cite></p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="webrtc_cc_evaluation.html" class="btn btn-neutral float-right" title="Congeston Control Evaluation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="webrtc_remb.html" class="btn btn-neutral float-left" title="Google REMB" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, walter.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>